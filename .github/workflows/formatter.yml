name: Formatting Check & PR

on: [push]

jobs:
 init:
   runs-on: ubuntu-latest

   steps:
   - name: Checkout code
     uses: actions/checkout@v2

   - name: Setup Nix
     uses: DeterminateSystems/nix-installer-action@v9

 format: 
   - name: Format Nix Files
     run: |
       nix run nixpkgs#alejandra -- .
       if git diff --quiet; then
           echo "No changes made."
           exit 0
       else
           git config --global user.email "github-actions[bot]@users.noreply.github.com"
           git config --global user.name "github-actions[bot]"
           git commit -am "Apply nixpkgs-fmt"
           git push
       fi
